"use strict";(self.webpackChunkworkers=self.webpackChunkworkers||[]).push([[634],{634:(e,t,a)=>{a.r(t),a.d(t,{default:()=>x});var s=a(858),i=a(403),r=a(899),l=a(216),o=a(3),n=a(43),d=a(702),c=a(154),u=a(64),m=a.n(u),h=a(93);const p="https://localhost:7079/api/Role",v=(e,t)=>{if("true"===localStorage.getItem("isDirector"))return t;const a=e.roles.filter((e=>e.isManagement));if(0===a.length)return[];return t.filter((e=>a.some((t=>t.role.id===e.id))))};a(50);var f=a(579);const j=r.Ik().shape({firstName:r.Yj().required("Required field").matches(/^[a-zA-Z ]{2,}$/,"\u05e9\u05dd \u05d7\u05d9\u05d9\u05d1 \u05dc\u05d4\u05db\u05d9\u05dc \u05dc\u05e4\u05d7\u05d5\u05ea 3 \u05ea\u05d5\u05d5\u05d9\u05dd \u05d5\u05dc\u05d4\u05db\u05d9\u05dc \u05d0\u05d5\u05ea\u05d9\u05d5\u05ea \u05d1\u05d0\u05e0\u05d2\u05dc\u05d9\u05ea \u05d1\u05dc\u05d1\u05d3"),lastName:r.Yj().required("Required field").matches(/^[a-zA-Z ]{2,}$/,"\u05e9\u05dd \u05d7\u05d9\u05d9\u05d1 \u05dc\u05d4\u05db\u05d9\u05dc \u05dc\u05e4\u05d7\u05d5\u05ea 3 \u05ea\u05d5\u05d5\u05d9\u05dd \u05d5\u05dc\u05d4\u05db\u05d9\u05dc \u05d0\u05d5\u05ea\u05d9\u05d5\u05ea \u05d1\u05d0\u05e0\u05d2\u05dc\u05d9\u05ea \u05d1\u05dc\u05d1\u05d3"),identity:r.Yj().required("Required field").matches(/^\d{9}$/,"\u05ea\u05e2\u05d5\u05d3\u05ea \u05d4\u05d6\u05d4\u05d5\u05ea \u05d7\u05d9\u05d9\u05d1\u05ea \u05dc\u05d4\u05db\u05d9\u05dc 9 \u05e1\u05e4\u05e8\u05d5\u05ea \u05d1\u05d3\u05d9\u05d5\u05e7"),startDate:r.p6().required("Required field").min(r.KR("dateOfBirth"),"\u05ea\u05d0\u05e8\u05d9\u05da \u05ea\u05d7\u05d9\u05dc\u05ea \u05d4\u05e2\u05d1\u05d5\u05d3\u05d4 \u05d7\u05d9\u05d9\u05d1 \u05dc\u05d4\u05d9\u05d5\u05ea \u05dc\u05d0\u05d7\u05e8 \u05ea\u05d0\u05e8\u05d9\u05da \u05d4\u05dc\u05d9\u05d3\u05d4"),dateOfBirth:r.p6().required("Required field"),password:r.Yj().required("Required field").min(6,"\u05d4\u05e1\u05d9\u05e1\u05de\u05d4 \u05d7\u05d9\u05d9\u05d1\u05ea \u05dc\u05d4\u05db\u05d9\u05dc \u05dc\u05e4\u05d7\u05d5\u05ea 6 \u05ea\u05d5\u05d5\u05d9\u05dd").matches(/(?=.*[a-z])/,"\u05d4\u05e1\u05d9\u05e1\u05de\u05d4 \u05d7\u05d9\u05d9\u05d1\u05ea \u05dc\u05db\u05dc\u05d5\u05dc \u05dc\u05e4\u05d7\u05d5\u05ea \u05d0\u05d5\u05ea \u05e7\u05d8\u05e0\u05d4 \u05d0\u05d7\u05ea").matches(/(?=.*[A-Z])/,"\u05d4\u05e1\u05d9\u05e1\u05de\u05d4 \u05d7\u05d9\u05d9\u05d1\u05ea \u05dc\u05db\u05dc\u05d5\u05dc \u05dc\u05e4\u05d7\u05d5\u05ea \u05d0\u05d5\u05ea \u05d2\u05d3\u05d5\u05dc\u05d4 \u05d0\u05d7\u05ea").matches(/(?=.*[0-9])/,"\u05d4\u05e1\u05d9\u05e1\u05de\u05d4 \u05d7\u05d9\u05d9\u05d1\u05ea \u05dc\u05db\u05dc\u05d5\u05dc \u05dc\u05e4\u05d7\u05d5\u05ea \u05de\u05e1\u05e4\u05e8 \u05d0\u05d7\u05d3"),gender:r.ai(),roles:r.YO().of(r.Ik().shape({role:r.Ik().shape({id:r.ai().nullable(),name:r.Yj().nullable()}).nullable(),isManagement:r.zM().nullable(),startDate:r.p6().required("Required field").min(r.KR("startDate"),"\u05ea\u05d0\u05e8\u05d9\u05da \u05ea\u05d7\u05d9\u05dc\u05ea \u05d4\u05e2\u05d1\u05d5\u05d3\u05d4 \u05d7\u05d9\u05d9\u05d1 \u05dc\u05d4\u05d9\u05d5\u05ea \u05dc\u05d0\u05d7\u05e8 \u05ea\u05d0\u05e8\u05d9\u05da \u05ea\u05d7\u05d9\u05dc\u05ea \u05d4\u05e2\u05d1\u05d5\u05d3\u05d4")}))}),x=()=>{var e;const t=(0,l.Zp)(),{state:a}=(0,l.zy)(),{user:r,roles:u}=(0,o.d4)((e=>({user:e.User.user,roles:e.Roles.roles}))),x=(0,o.wA)(),{register:y,handleSubmit:g,formState:{errors:b},control:N}=(0,s.mN)({resolver:(0,i.t)(j),defaultValues:{firstName:null===a||void 0===a?void 0:a.firstName,lastName:null===a||void 0===a?void 0:a.lastName,identity:null===a||void 0===a?void 0:a.identity,password:null===a||void 0===a?void 0:a.password,startDate:null===a||void 0===a?void 0:a.startDate.split("T")[0],dateOfBirth:null===a||void 0===a?void 0:a.dateOfBirth.split("T")[0],gender:null===a||void 0===a?void 0:a.gender,roles:(null===a||void 0===a?void 0:a.roles.map((e=>({...e,startDate:e.startDate.split("T")[0]}))))||[]}}),{fields:w,append:D,remove:k}=(0,s.jz)({control:N,name:"roles"}),[q,A]=(0,n.useState)([]);function C(){const e=[];w.map((t=>{e.push(+t.role.id)})),console.log(e),A(e)}(0,n.useEffect)((()=>{C()}),[]);const[B,E]=(0,n.useState)(null===a||void 0===a?void 0:a.startDate.split("T")[0]),[O,R]=(0,n.useState)({name:""});function I(e,t,a){var s;let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"text";return(0,f.jsxs)("div",{className:"field",children:[(0,f.jsxs)("label",{children:[e,":"]}),(0,f.jsxs)("div",{className:"ui right icon input",children:[(0,f.jsx)("input",{type:i,placeholder:e,...y(t)}),(0,f.jsx)("i",{className:"".concat(a," icon")})]}),b[t]&&(0,f.jsx)("p",{className:"ui pointing red basic label",children:null===(s=b[t])||void 0===s?void 0:s.message})]})}return(0,n.useEffect)((()=>{x((e=>async t=>{try{const a=await c.A.get(p);t({type:h.dE,data:v(e,a.data)})}catch(a){console.error(a)}})(r))}),[O]),(0,f.jsxs)("div",{className:"square-box edit",children:[(0,f.jsx)("br",{}),(0,f.jsx)("button",{className:"close-button",onClick:()=>t("/EmployeeList"),children:(0,f.jsx)("i",{className:"window close icon"})}),"true"==localStorage.getItem("isDirector")&&(0,f.jsxs)("div",{id:"form",children:[(0,f.jsx)("input",{type:"text",placeholder:"enter role",name:"role",onChange:e=>{R((t=>({...t,name:e.target.value})))}}),(0,f.jsx)("button",{className:"button but",onClick:()=>{x((e=>async t=>{try{const a=await c.A.post(p,{Name:e.name,Star:e.star});t({type:h.br,data:a.data}),m().fire({icon:"success",title:"".concat(e.name," Added to the job list"),showConfirmButton:!1,timer:1e3})}catch(a){m().fire({icon:"error",title:"".concat(a,": Add failed"),showConfirmButton:!1,timer:1e3}),console.error(a)}})(O))},children:"\u05d4\u05d5\u05e1\u05e3 \u05ea\u05e4\u05e7\u05d9\u05d3"})]}),(0,f.jsx)("div",{id:"container",children:(0,f.jsx)("div",{id:"form",className:"ui placeholder segment",children:(0,f.jsx)("form",{onSubmit:g((e=>{var s=[];e.roles.forEach((e=>{alert(e.role.id);var t={roleId:e.role.id,startDate:e.startDate,isManagement:e.isManagement};s.push(t)})),e.roles=s;const i={...e,active:(null===a||void 0===a?void 0:a.active)||!0,Id:null===a||void 0===a?void 0:a.id};null!==a&&x((0,d.JE)(i))||null==a&&x((0,d.Ql)(i)),t("/EmployeeList")})),children:(0,f.jsx)("div",{className:"ui one column very relaxed stackable grid",children:(0,f.jsx)("div",{className:"column",children:(0,f.jsxs)("div",{className:"ui form",children:[(0,f.jsxs)("div",{children:[I("firstName:","firstName","user"),I("lastName:","lastName","user"),I("identity:","identity","address book outline"),I("password:","password","lock","password"),I("birthDate:","dateOfBirth","calendar alternate outline","date"),(0,f.jsxs)("div",{className:"field",children:[(0,f.jsx)("label",{children:"startDate:"}),(0,f.jsxs)("div",{className:"ui rigth icon input",children:[(0,f.jsx)("input",{placeholder:"startDate",...y("startDate"),type:"date",onChange:e=>E(e.target.value)}),(0,f.jsx)("i",{className:"calendar alternate outline icon"})]}),b.startDate&&(0,f.jsx)("p",{className:"ui pointing red basic label",children:null===(e=b.startDate)||void 0===e?void 0:e.message})]}),(0,f.jsxs)("div",{className:"field",children:[(0,f.jsx)("label",{children:"gender:"}),(0,f.jsxs)("select",{id:"gender",...y("gender"),children:[(0,f.jsx)("option",{value:1,children:"male"}),(0,f.jsx)("option",{value:2,children:"female"})]})]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("h2",{children:"\u05ea\u05e4\u05e7\u05d9\u05d3\u05d9\u05dd:"}),w.map(((e,t)=>{var s,i,r,l;return(0,f.jsxs)("div",{id:"card",children:[(0,f.jsxs)("div",{className:"field",children:[(0,f.jsxs)("label",{children:[t+1," role:"]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("button",{onClick:()=>{k(t),C()},children:(0,f.jsx)("i",{className:"trash icon"})}),(0,f.jsx)("select",{...y("roles[".concat(t,"].role.id")),defaultValue:(null===a||void 0===a||null===(s=a.roles[t])||void 0===s||null===(i=s.role)||void 0===i?void 0:i.id)||"",onChange:e=>C(),children:u.map((e=>{const t=q.includes(e.id);return(0,f.jsxs)("option",{value:e.id,disabled:t,children:[" ",e.name," "]},e.id)}))})]})]}),I("Management:","roles[".concat(t,"].isManagement"),"mail ","checkbox"),(0,f.jsxs)("div",{className:"field",children:[(0,f.jsx)("label",{children:"startDate:"}),(0,f.jsxs)("div",{className:"ui input",children:[(0,f.jsx)("input",{placeholder:"startDate",min:B,type:"date",...y("roles[".concat(t,"].startDate"))}),(null===b||void 0===b?void 0:b.roles)&&(null===(r=b.roles[t])||void 0===r?void 0:r.startDate)&&(0,f.jsx)("p",{className:"ui pointing red basic label",children:null===(l=b.roles[t].startDate)||void 0===l?void 0:l.message})]})]})]},t)}),(0,f.jsx)("br",{})),(0,f.jsx)("button",{className:"button but",onClick:e=>{e.preventDefault(),D({}),C()},children:"add role"})]}),", ",(0,f.jsx)("br",{}),(0,f.jsx)("button",{type:"submit",className:"button but",children:"save employee"})]})})})})})})]})}},702:(e,t,a)=>{a.d(t,{Ii:()=>c,JE:()=>h,Ql:()=>m,Qu:()=>u,l3:()=>d});var s=a(93),i=a(154),r=a(64),l=a.n(r);const o="https://localhost:7079/api/Employee",n=(e,t)=>{if("true"===localStorage.getItem("isDirector"))return t;const a=e.roles.filter((e=>e.isManagement));if(0===a.length)return[];return t.filter((t=>a.some((a=>t.roles.some((s=>s.role.id===a.role.id||e.id===t.id))))))},d=e=>async t=>{try{const a=await i.A.get(o),r=n(e,a.data);t({type:s.dO,data:r})}catch(a){console.error(a)}},c=(e,t)=>async a=>{try{const r=await i.A.get("".concat(o,"/name=").concat(t)),l=n(e,r.data);a({type:s.dO,data:l})}catch(r){console.error(r)}},u=e=>async t=>{try{await i.A.delete("".concat(o,"/").concat(e)),l().fire({position:"top",icon:"success",title:"The employee has been marked as inactive",showConfirmButton:!1,timer:1e3}),t({type:s.j2,data:e})}catch(a){l().fire({icon:"error",title:"Oops...",text:"Error deleting employee",footer:'<a href="#">Back to adding an employee?/a>'})}},m=e=>async t=>{try{const a=await i.A.post(o,e);t({type:s.ls,data:a.data}),l().fire({position:"top",icon:"success",title:"The employee was successfully added",showConfirmButton:!1,timer:1500})}catch(a){l().fire({icon:"error",title:"Oops...",text:"Adding employee failed",footer:'<a href="#">Back to adding an employee?</a>'})}},h=e=>async t=>{try{const a=await i.A.put("".concat(o,"/").concat(e.Id),{...e});t({type:s.uv,data:a.data}),l().fire({position:"top",icon:"success",title:"The employee details have been updated successfully",showConfirmButton:!1,timer:1500})}catch(a){l().fire({icon:"error",title:"Oops...",text:"Error editing employee",footer:'<a href="#">Back to employees/a>'})}}}}]);
//# sourceMappingURL=634.fcd18694.chunk.js.map